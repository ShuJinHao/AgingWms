<Window
    x:Class="AgingWms.Client.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="WMS 仓储 &amp; 老化工作流测试终端"
    Width="1000"
    Height="700">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260" />
                <ColumnDefinition Width="180" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <GroupBox Padding="5" Header="基础参数">
                    <StackPanel>
                        <TextBlock FontWeight="Bold" Text="起始库位ID (SlotId):" />
                        <TextBox
                            x:Name="txtSlotId"
                            Margin="0,5,0,5"
                            Padding="5"
                            Text="1-1-1" />

                        <TextBlock FontWeight="Bold" Text="托盘条码 (TrayCode):" />
                        <TextBox
                            x:Name="txtTrayCode"
                            Margin="0,5,0,5"
                            Padding="5"
                            Text="TRAY001" />

                        <TextBlock FontWeight="Bold" Text="模拟电芯数量:" />
                        <TextBox
                            x:Name="txtCellCount"
                            Margin="0,5,0,5"
                            Padding="5"
                            Text="24" />
                    </StackPanel>
                </GroupBox>

                <GroupBox
                    Margin="0,10,0,0"
                    Padding="5"
                    Header="批量/多库位设置">
                    <StackPanel>
                        <TextBlock FontWeight="Bold" Text="批量生成数量 (Count):" />
                        <TextBox
                            x:Name="txtBatchCount"
                            Margin="0,5"
                            Padding="5"
                            Text="1" />
                        <TextBlock
                            FontSize="11"
                            Foreground="Gray"
                            Text="说明: 若数量&gt;1，将自动生成 1-1-1, 1-1-2..."
                            TextWrapping="Wrap" />
                    </StackPanel>
                </GroupBox>

                <TextBlock
                    Margin="0,10,0,0"
                    FontWeight="Bold"
                    Text="目标库位 (仅迁移用):" />
                <TextBox
                    x:Name="txtTargetSlotId"
                    Margin="0,5,0,10"
                    Padding="5"
                    Text="1-1-2" />
            </StackPanel>

            <StackPanel Grid.Column="1" Margin="10,0">
                <TextBlock
                    Margin="0,0,0,5"
                    FontWeight="Bold"
                    Foreground="Gray"
                    Text="基础 WMS 操作" />

                <Button
                    x:Name="btnWrite"
                    Height="35"
                    Margin="0,0,0,5"
                    Click="btnWrite_Click"
                    Content="1. 批量入库 (Write)" />

                <Button
                    x:Name="btnMove"
                    Height="35"
                    Margin="0,0,0,5"
                    Background="#FFF1D8AB"
                    Click="btnMove_Click"
                    Content="2. 库位迁移 (Move)" />

                <Button
                    x:Name="btnRemove"
                    Height="35"
                    Margin="0,0,0,5"
                    Background="#FFF1ABAB"
                    Click="btnRemove_Click"
                    Content="3. 库位移除 (Clear)" />

                <Separator Height="15" />

                <TextBlock
                    Margin="0,0,0,5"
                    FontWeight="Bold"
                    Foreground="Blue"
                    Text="老化工作流控制" />

                <Button
                    x:Name="btnStartWorkflow"
                    Height="40"
                    Margin="0,0,0,5"
                    Background="#FFB9E0A5"
                    Click="btnStartWorkflow_Click"
                    Content="▶ 启动流程 (Start)"
                    FontWeight="Bold" />

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button
                        x:Name="btnPause"
                        Grid.Column="0"
                        Height="30"
                        Margin="0,0,2,5"
                        Click="btnPause_Click"
                        Content="⏸ 暂停" />
                    <Button
                        x:Name="btnResume"
                        Grid.Column="1"
                        Height="30"
                        Margin="2,0,0,5"
                        Click="btnResume_Click"
                        Content="⏯ 恢复" />
                </Grid>

                <Button
                    x:Name="btnStop"
                    Height="30"
                    Margin="0,0,0,10"
                    Background="#FFFF8888"
                    Click="btnStop_Click"
                    Content="⏹ 强制停止" />
            </StackPanel>

            <GroupBox Grid.Column="2" Header="系统日志">
                <TextBox
                    x:Name="txtLog"
                    FontFamily="Consolas"
                    FontSize="12"
                    IsReadOnly="True"
                    TextWrapping="Wrap"
                    VerticalScrollBarVisibility="Auto" />
            </GroupBox>
        </Grid>

        <GroupBox
            Grid.Row="1"
            Margin="0,10,0,0"
            Header="多库位实时监控看板 (Real-time Monitor)">
            <DataGrid
                x:Name="dgMonitor"
                AutoGenerateColumns="False"
                FontSize="13"
                GridLinesVisibility="Horizontal"
                HeadersVisibility="Column"
                IsReadOnly="True"
                RowHeight="35">
                <DataGrid.Columns>
                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding SlotId}"
                        FontWeight="Bold"
                        Header="库位ID" />
                    <DataGridTextColumn
                        Width="100"
                        Binding="{Binding TrayBarcode}"
                        Header="托盘码" />

                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding Status}"
                        Header="当前状态" />
                    <DataGridTextColumn
                        Width="120"
                        Binding="{Binding CurrentStep}"
                        Foreground="Blue"
                        Header="执行工步" />

                    <DataGridTemplateColumn Width="150" Header="工步进度">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <ProgressBar
                                        Height="15"
                                        Maximum="100"
                                        Value="{Binding Progress}" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="10"
                                        Foreground="Black"
                                        Text="{Binding DurationInfo}" />
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding Voltage, StringFormat=F4}"
                        FontWeight="Bold"
                        Header="电压 (V)" />
                    <DataGridTextColumn
                        Width="80"
                        Binding="{Binding Current, StringFormat=F3}"
                        Header="电流 (A)" />

                    <DataGridTemplateColumn Width="80" Header="温度 (°C)">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontWeight="Bold"
                                    Foreground="{Binding TempColor}"
                                    Text="{Binding Temperature, StringFormat=F1}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTextColumn
                        Width="100"
                        Binding="{Binding Capacity, StringFormat=F4}"
                        Header="累计容量 (Ah)" />

                    <DataGridTextColumn
                        Width="*"
                        Binding="{Binding Message}"
                        Foreground="Gray"
                        Header="系统消息" />
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>
    </Grid>
</Window>